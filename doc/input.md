Взаимодействие с игроком осуществляется через устройства ввода:

- клавиатура,
- геймпад,
- мышь,
- тачскрин.

Также возможно голосовое управление.

Обработка ввода включает себя регистрацию событий.

Для клавиатуры и геймпада:

- событие нажатия клавиши
- событие отпускания клавиши
- проверка что клавиша нажата
- проверка что клавиша отпущена
- сочетание клавиш
- последовательность нажатия клавиш

Для мыши и тачскрина:

- событие перемещения мыши по оси x
- событие перемещения мыши по оси y
- событие прокрутки колеса
- событие нажатия клавиши
- событие отпускания клавиши
- проверка что клавиша нажата
- проверка что клавиша отпущена
- сочетание клавиш
- последовательность нажатия клавиш
- клик по точке на экране
- жесты

важно:

- мышь может быть привязана к объекту курсор
- может обрабатываться одновременно несколько устройств ввода

Но в общем и целом взаимодействие с игрой происходит через команды.

Команды регистрируются в специальном классе.

Например, обычно управление игрой строится так:

Если нажата клавиша вправо, то объект игрока движется вправо.

Но если мы начнем дополнять условия, это управление станет слишком сложным:

- если нажата клавиша вправо на клавиатуре
- или крестик геймпада больше 0 по оси X
- или
- если включено управление с тачскрина
- и нажата область кнопки движения вправо
- при этом
- если персонаж не движется по оси Y
- то объект игрока движется вправо
- и его спрайт не становится отзеркаленным по горизонтали

Видите, как сложно.

И это только обработка одного простого действия.

За счет класса команд, условие будет разделяться на блоки.

Создаем команду "ВПРАВО" и она срабатывает, когда:

- нажата клавиша вправо на клавиатуре
- или крестик геймпада больше 0 по оси X
- или
- включено управление с тачскрина
- и нажата область кнопки движения вправо

Активация команды "ВПРАВО" проверяет следующее условие:

- если персонаж не движется по оси Y

И если все в порядке, то:

- и меняет свое состояние на "вправо"

А отрисовку спрайтов и движение назначаем на состояния игрока. И если у игрока состояние "вправо", то:

- объект игрока движется вправо
- и его спрайт не становится отзеркаленным по горизонтали

Вот и все.

Конечно, команд в игре может быть больше, чем просто движение влево, вправо, вверх, вниз и команда атаки.

В более широком смысле, команды позволят управлять игрой голосом, через vr или любые другие устройства ввода.

В текстовых квестах комманды могут опираться на текстовый ввод пользователя. Преобразовывать текст в команды можно через библиотеки или через нейросети.

Благодаря командам, вы инкапсулируете управление в одном классе. А благодаря менеджеру состояний объекта, вы абстрагируете сложную логику.

И управление игровыми объектами становится простым и понятным.
